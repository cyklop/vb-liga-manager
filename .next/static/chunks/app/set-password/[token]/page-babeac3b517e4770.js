(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[320],{97262:function(e,t,s){Promise.resolve().then(s.bind(s,77177))},99376:function(e,t,s){"use strict";var r=s(35475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},77177:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var r=s(57437),a=s(2265),n=s(99376),i=s(18618);function l(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),s=e.token,[l,o]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[c,m]=(0,a.useState)(""),[h,g]=(0,a.useState)(""),[p,f]=(0,a.useState)(!1),y=async e=>{if(e.preventDefault(),m(""),g(""),!s){m("Ung\xfcltiger oder fehlender Setup-Token.");return}if(l!==d){m("Die Passw\xf6rter stimmen nicht \xfcberein.");return}if(l.length<6){m("Das Passwort muss mindestens 6 Zeichen lang sein.");return}f(!0);try{let e=await fetch("/api/auth/set-initial-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s,password:l})}),r=await e.json();e.ok?(g(r.message||"Dein Passwort wurde erfolgreich festgelegt. Du kannst dich jetzt anmelden."),setTimeout(()=>{t.push("/login")},3e3)):m(r.message||"Fehler beim Festlegen des Passworts.")}catch(e){console.error("Set initial password failed:",e),m("Ein unerwarteter Fehler ist aufgetreten. Bitte versuche es sp\xe4ter erneut.")}finally{f(!1)}};return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-100 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)(i.Card,{color:"transparent",shadow:!1,placeholder:void 0,className:"dark:bg-gray-800/30 p-6",children:[(0,r.jsx)(i.Typography,{variant:"h4",color:"blue-gray",placeholder:void 0,className:"dark:text-gray-100",children:"Passwort festlegen"}),(0,r.jsx)(i.Typography,{color:"gray",className:"mt-1 font-normal dark:text-gray-300",placeholder:void 0,children:"Willkommen! Bitte lege dein Passwort fest, um dein Konto zu aktivieren."}),(0,r.jsx)("form",{onSubmit:y,className:"mt-8 mb-2 w-80 max-w-screen-lg sm:w-96",children:h?(0,r.jsx)(i.Typography,{color:"green",className:"mt-4 text-center text-sm",placeholder:void 0,children:h}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-4 flex flex-col gap-6",children:[(0,r.jsx)(i.Input,{type:"password",size:"lg",label:"Neues Passwort",value:l,onChange:e=>o(e.target.value),placeholder:void 0,crossOrigin:void 0,className:"dark:text-gray-200 dark:border-gray-500",disabled:p}),(0,r.jsx)(i.Input,{type:"password",size:"lg",label:"Neues Passwort best\xe4tigen",value:d,onChange:e=>u(e.target.value),placeholder:void 0,crossOrigin:void 0,className:"dark:text-gray-200 dark:border-gray-500",disabled:p})]}),c&&(0,r.jsx)(i.Typography,{color:"red",className:"mt-2 text-center text-sm",placeholder:void 0,children:c}),(0,r.jsx)(i.Button,{className:"mt-6",fullWidth:!0,type:"submit",placeholder:void 0,disabled:p,children:p?"Wird verarbeitet...":"Passwort festlegen & Anmelden"})]})})]})})}}},function(e){e.O(0,[384,768,971,117,744],function(){return e(e.s=97262)}),_N_E=e.O()}]);